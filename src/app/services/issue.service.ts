import { Injectable } from '@angular/core';
import * as _ from 'lodash';

import { mockAminets } from '../mockData/aminets.mockData';
import { CreateIssueModel } from '../models/create-issue-model';

@Injectable({
  providedIn: 'root'
})
export class IssueService {

  private draftKey: string;

  constructor() {
    this.draftKey = btoa('create-issue-draft');
  }

  getRegions() {
    return ['Germany', 'United Kingdom / Ireland', 'Asia Pacific', 'Americas', 'EMEA'];
  }

  getFrequency() {
    return ['Daily', 'Weekly', 'Monthly', 'Quarterly', 'Anually'];
  }

  getAminets(key: string = '*'): any[] {

    if (_.isEmpty(key)) {
      return [];
    }

    if (key === '*') {
      // Return everything;
      return mockAminets.map(i => i.aminet);
    }

    return mockAminets.filter(i => {
      return _.includes(i, key.toLowerCase());
    });
  }

  getSourceSystems(): string[] {
    return [
      'Source 1',
      'source 2',
      'Source 3'
    ];
  }

  getProducts(): string[] {
    return [
      'Product 1',
      'Product 2',
      'Product 3'
    ];
  }

  getHighLevelImpact(): string[] {
    return [
      'Impact 1',
      'Impact 2',
      'Impact 3',
      'Impact 4'
    ];
  }

  getInfrastructure() {
    return ['Finance', 'Regulation, Compliance and Anti-Financial Crime', 'Risk', 'Treasury'];
  }

  getConventions() {
    return [
      {
        id: 1,
        label: 'Convention 1',
        colour: '#baddff'
      },
      {
        id: 2,
        label: 'Convention 2',
        colour: '#9dcfff'
      },
      {
        id: 3,
        label: 'Convention 3',
        colour: '#50a9ff'
      },
      {
        id: 4,
        label: 'Convention 4',
        colour: '#0383ff'
      }
    ];
  }

  getAssetClass() {
    return [
      {
        id: 0,
        colour: "#baddff",
        label: "C1 Asset 1"
      },
      {
        id: 1,
        colour: "#baddff",
        label: "C1 Asset 2"
      },
      {
        id: 2,
        colour: "#baddff",
        label: "C1 Asset 3"
      },
      {
        id: 3,
        colour: "#baddff",
        label: "C1 Asset 4"
      },
      {
        id: 4,
        colour: "#9dcfff",
        label: "C2 Asset 1"
      },
      {
        id: 5,
        colour: "#9dcfff",
        label: "C2 Asset 2"
      },
      {
        id: 6,
        colour: "#9dcfff",
        label: "C2 Asset 3"
      },
      {
        id: 7,
        colour: "#9dcfff",
        label: "C2 Asset 4"
      },
      {
        id: 8,
        colour: "#50a9ff",
        label: "C3 Asset 1"
      },
      {
        id: 9,
        colour: "#50a9ff",
        label: "C3 Asset 2"
      },
      {
        id: 10,
        colour: "#50a9ff",
        label: "C3 Asset 3"
      },
      {
        id: 11,
        colour: "#50a9ff",
        label: "C3 Asset 4"
      },
      {
        id: 12,
        colour: "#0383ff",
        label: "C4 Asset 1"
      },
      {
        id: 13,
        colour: "#0383ff",
        label: "C4 Asset 2"
      },
      {
        id: 14,
        colour: "#0383ff",
        label: "C4 Asset 3"
      },
      {
        id: 15,
        colour: "#0383ff",
        label: "C4 Asset 4"
      }
    ];
  }

  getBusinessImpactData(): any[] {
    return [
      {
        lvl1Impact: 'High Level Impact 1',
        lvl2Impacts: [
          'Low 1.A',
          'Low 1.B',
          'Low 1.C',
        ]
      },
      {
        lvl1Impact: 'High Level Impact 2',
        lvl2Impacts: [
          'Low 2.D',
          'Low 2.E',
          'Low 2.F',
        ]
      },
      {
        lvl1Impact: 'High Level Impact 3',
        lvl2Impacts: [
          'Low 3.G',
          'Low 3.H',
          'Low 3.I',
        ]
      }
    ];
  }

  getSavedDraft(): CreateIssueModel {
    let savedDraft = localStorage.getItem(this.draftKey);

    if (_.isEmpty(savedDraft)) {
      return null;
    }

    return <CreateIssueModel>JSON.parse(atob(savedDraft));
  }

  getDataSetSupportEmail() {
    return 'barry@bird.com';
  }

  getWorkstreams(): string[] {
    return ['50100', '50101', '50102', '50103', '50104', '50105', '50106'];
  }

  getConnectedAdjustments(): string[] {
    return [
      'FDW FaAWS (DPB)',
      'FDW FaAWS (non-DPB)',
      'Paragon CDW',
      'Pomona DBV',
      'Pomona ECB',
      'Pomona FRD',
      'Pomona IFRS9',
      'Pomona STMX',
      'Pomona TDBP',
      'Pomona TLA'
    ];
  }

  getDataCreationLocations(): string[] {
    return [
      'BCS',
      'FDW',
      'Other',
      'Paragon',
      'SAP',
      'TDH',
    ];
  }

  getReportCorrectionLocations(): string[] {
    return [
      'Axiom (non-US',
      'Axiom IHC (US)',
      'HyperStar external reports',
      'LiquidityStar external reports',
      'Other',
      'Saturn'
    ];
  }

  getMonetaryImpacts(): string[] {
    return [
      'Actual cost',
      'Balance sheet',
      'Leveraged Balance sheet',
      'Liquidity coverage ratio',
      'Notional',
      'Off-balance sheet',
      'P&L',
      'Revenue',
      'RWA'
    ];
  }

  getClientImpacts(): string[] {
    return [
      'Client complaints',
      'Delivery SLA missed',
      'Inaccurate data sent to client'
    ];
  }

  getEpmLevels(): string[] {
    return [
      'EPM Level 1',
      'EPM Level 2',
      'EPM Level 3'
    ];
  }

  getAuditPointTypes(): string[] {
    return [
      'Internal',
      'External',
      'Regulator',
      'Self identified'
    ];
  }

  getFindingRatings(): string[] {
    return ['F1', 'F2', 'F3', 'F4'];
  }

  getRegulators(): string[] {
    return [
      'BaFin',
      'Bank of England (BoE)',
      'Commodities and Futures Trading Commission (CFTC)',
      'Deutsche Bundesbank',
      'European Central Bank',
      'Federal Reserve',
      'HM Treasure',
      'Securities and Exchange Commission (SEC)',
      'Fincancial Conduct Authority (FCA)',
      'European Securities and Markets Authority (ESMA)'
    ];
  }

  getRegulatoryReport(): string[] {
    return [
      'FED 5G',
      'FFIEC 002',
      'FFIEC 009',
      'FFIEC 009A',
      'FFIEC 041',
      'FR Y-12',
      'FR Y-12A',
      'FR Y-14A',
      'FR Y-14M',
      'FR Y-14Q',
      'FR Y-9C',
      'FR Y-9LP',
      'TIC B',
      'TIC D',
      'TIC S',
      'TIC SHC (A)',
      'TIC SHL (A)',
      'TIC SLT',
    ];
  }

  // Storage functions

  saveDraft(draftResponse: CreateIssueModel) {
    localStorage.setItem(this.draftKey, btoa(JSON.stringify(draftResponse)));
  }

  deleteDraft() {
    localStorage.removeItem(this.draftKey);
  }

  saveIssue(issue: CreateIssueModel) {
    // Send to server
  }

}
